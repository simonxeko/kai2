#! /usr/bin/env node

{"version":3,"sources":["../src/app.ts"],"names":[],"mappings":"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","file":"app.js","sourcesContent":["import { REPLCommand } from 'repl';\nimport { Cipher } from 'tls';\nimport { version } from 'punycode';\nimport * as vm from 'vm';\n\nconst fs = require('fs');\nconst colors = require('colors');\nconst os = require('os');\nconst shell = require(\"shelljs\");\nconst fetch = require('node-fetch');\nconst spawn = require('child_process').spawn;\nconst cheerio = require('cheerio');\nconst argv = process.argv;\nlet verbose = false;\nlet debug = (str: String) => {\n    if (verbose) {\n        console.log(str.grey);\n    }\n}\nif (argv.indexOf('-v') > 0) {\n    verbose = true;\n    argv.splice(argv.indexOf('-v'),1);\n}\n\nconst USER_HOME = os.homedir();\nlet C: any = {shortcut: {}};\nlet initJSON = \"\";\n\ntry {\n    initJSON = fs.readFileSync(`${USER_HOME}/.kai/settings.json`, 'utf-8').toString();\n    C = JSON.parse(initJSON);\n} catch (e) {\n    if (e.name == \"SyntaxError\") {\n        console.log((\"Syntax Error in ~/.kai/settings.json\").red);\n        process.exit(-1);\n    }\n    try {\n        fs.mkdirSync(`${USER_HOME}/.kai`);\n    } catch (eMkdir) {\n\n    }\n    fs.writeFileSync(`${USER_HOME}/.kai/settings.json`, '{shortcut:{}}');\n    C = {shortcut:{}};\n}\n\nlet sentence = argv.slice(2).map((v) => (v.replace(' ', '\\\\ '))).join(\" \");\n\ninterface IPattern {\n    re: RegExp;\n    handler: Function;\n}\n\nvar patterns: Array<IPattern> = [];\n\n// TODO: Integration with Api.ai to the top layer.\n\n// Basic Module ( shortcut and note memory )\npatterns.push({ re: /^(go[ ]?to|jump[ ]?to) (.+)$/, handler: onGoto });\npatterns.push({ re: /^(forget|forgot|delete|remove) (.+)$/, handler: onForget });\npatterns.push({ re: /^(remember|record|note|save|memo) (['\"]?.+['\"]?) (as)? (['\"]?.+?['\"]?)$/, handler: onRemember }); // kai remember here as 'webdev' -> kai goto webdev\npatterns.push({ re: /^where[ ]?is[ ]?(.+)$/, handler: onWhere });\npatterns.push({ re: /^(set key|unset key|get key) ([^ ]+)[ ]?[=]?[ ]?(.*)$/, handler: onSet });\npatterns.push({ re: /^(run|exec|r|e) (.+)$/, handler: onRun });\npatterns.push({ re: /^(show) (.+)$/, handler: onShow });\n\n// Google\npatterns.push({ re: /^google (.+)$/, handler: onGoogle });\npatterns.push({ re: /^(stackoverflow|stack) (.+)$/, handler: onStackoverflow });\n\n// Joke Module\npatterns.push({ re: /^tell me a joke$/, handler: onJoke });\n\nfunction fuzzySearch(query: string): Array<string>{\n    let result: Array<string> = [];\n    Object.keys(C.shortcut).map((i: string) => {\n        if(i.indexOf(query) == 0) {\n            result.push(i);\n        } else if (~i.split(' ').indexOf(query)) {\n            result.push(i);\n        }\n    });\n    return result.map(v => v.cyan);\n}\n\nfunction combineWords(words: Array<string>) {\n    if (words.length == 0) return '';\n    if (words.length == 1) { return words[0]; }\n    if (words.length == 2) { return words[0] + ' or ' + words[1]; }\n    let finalWord = words.pop();\n    return words.join(',') + ' or ' + finalWord;\n}\n\nfunction onGoto(result) {\n    let key = result[2];\n    let path = C.shortcut[key];\n\n    if (!path) {\n        let fuzzyResult = fuzzySearch(key);\n        if(fuzzyResult.length > 0){\n            console.log('Do you mean \"kai go to' +(combineWords(fuzzyResult))+ '\"?');\n        } else {\n            console.log(`I don't know where ${key} is.`);\n        }\n    } else {\n        console.log(`Jumping to ${path}`);\n        fs.writeFileSync(`${USER_HOME}/.kai/cd`, path);\n    }\n}\n\nfunction onRun(result) {\n    let key = result[2];\n    let cmd = C.shortcut[key];\n\n    if (!cmd) {\n        let fuzzyResult = fuzzySearch(key);\n        if(fuzzyResult.length > 0){\n            console.log('Do you mean \"kai run ' +(combineWords(fuzzyResult))+ '\"?');\n        } else {\n            console.log(`I don't know what ${key} means.`);\n        }\n    } else { \n        console.log(`Executing ${cmd}`.grey);\n        let cmd_token = cmd.replace(/\\\\ /g,'\\\\\\\\space\\\\\\\\').split(' ').map((v)=>(v.replace(/\\\\\\\\space\\\\\\\\/g, ' ')));\n        spawn(cmd_token[0], cmd_token.splice(1), { env: process.env, stdio: [0,1,2] });\n    }\n}\n\nfunction onShow(result) {\n    let key = result[2];\n    let note = C.shortcut[key];\n\n    if (key == 'all') {\n        note = '';\n        Object.keys(C.shortcut).map((i) => {\n            note += i + ' => ' + C.shortcut[i] + '\\r\\n';\n        });\n    }\n\n    if (!note) {\n        let fuzzyResult = fuzzySearch(key);\n        if(fuzzyResult.length > 0){\n            console.log('Do you mean \"kai show ' +(combineWords(fuzzyResult))+ '\"?');\n        } else {\n            console.log(`I don't know what ${key} means.`);\n        }\n    } else { \n        console.log(note);\n    }\n}\n\nfunction onForget(result) {\n    let key = result[2];\n    let path = C.shortcut[key];\n\n    if (!path) {\n        console.log(`${key} means nothing to me.`);\n    } else {\n        console.log(`OK, I'll forget ${key} (${path})`);\n        delete C.shortcut[key];\n    }\n}\n\nfunction onRemember(result) {\n    let path = result[2],\n        key = result[4];\n    if (!C.shortcut) { C.shortcut = {}; }\n    if (path === \".\" || path === \"here\" || path === \"this folder\") path = process.cwd();\n    C.shortcut[key] = path;\n    console.log(`Remembering ${path} as ${key}`.green);\n}\n\nfunction onWhere(result) {\n    let key = result[1];\n    let path = C.shortcut[key];\n\n    if (!path) {\n        console.log(`I don't know where ${key} is.`);\n    } else {\n        console.log(`It is located at ${path}`);\n    }\n}\n\nfunction onGoogle(result) {\n    spawn('open', ['https://www.google.com.tw/webhp?ie=UTF-8#q='+encodeURIComponent(result[1])]);\n}\n\nfunction onJoke(result) {\n    fetch('http://tambal.azurewebsites.net/joke/random').then(function(res) {\n        return res.json();\n    }).then(function(json) {\n        console.log(json.joke);\n    });\n}\n\nfunction onSet(result){\n    let cmd = result[1],\n        key = result[2],\n        val = result[3];\n    \n    if (!C.keys) { C.keys = {}; }\n    if (!~['google_cx', 'google_api_key'].indexOf(key)) {\n        console.log(\"Key ${key} not supported\");\n    }\n\n    if (cmd == \"unset key\") {\n        delete C.keys[key];\n        console.log(`Key ${key} deleted.`);\n    } else if(cmd==\"get key\") {\n        console.log(`Key \"${key}\" = \"${C.keys[key]}\".`);\n    } else if(val && cmd == \"set key\") {\n        C.keys[key] = val;\n        console.log(`Setting \"${key}\" = \"${val}\".`);\n    }\n\n}\n\nfunction onStackoverflow(result){\n    let parsingLink = false;\n    let linkName = \"\";\n    let pageLink = \"\";\n\n    if (!C.keys || !C.keys['google_cx'] || !C.keys['google_api_key']) {\n        return console.log('You must run `kai set google_cx = [your custom search engine index]` & `kai set google_api_key = [your google api key]` first. See https://developers.google.com/custom-search/json-api/v1/overview.');\n    }\n\n    let url = `https://www.googleapis.com/customsearch/v1?q=${encodeURIComponent(result[2])}&cx=${C.keys['google_cx']}&key=${C.keys['google_api_key']}`;\n    console.log(\"By the power of \" + \"Google\".rainbow + \" ...\\n\");\n    fetch(url).then((res) => {\n        return res.json();\n    }).then((result)=>{\n        result.items.map((v, i) => {\n            if (i!=0) return;\n            console.log(`*** ${v.title} ***`);\n            fetch(v.link).then(res => res.text()).then((html) => {\n                let $ = cheerio.load(html);\n                console.log($('.answer.accepted-answer .post-text').text());\n            });\n        });\n    })\n}\n\ndebug(\"Sentence \" + sentence);\n\nlet matches:Array<{result: RegExpExecArray, pattern: IPattern}> = [];\n\npatterns.map((v: IPattern) => {\n    let result: RegExpExecArray | null = v.re.exec(sentence);\n    if (result) {\n        matches.push({result: result, pattern: v});\n    }\n});\n\nif (matches.length > 1) {\n    debug(\"DEBUG:: Command matched twice\".red);\n}\n\nmatches.map((v: {result: RegExpExecArray, pattern: IPattern}) => {\n    debug(\"Matched \" + v.pattern.re.source);\n    v.pattern.handler(v.result);\n});\n\nlet endJSON = JSON.stringify(C);\nif (initJSON != endJSON) {\n    fs.writeFileSync(`${USER_HOME}/.kai/settings.json`, endJSON + \"\\n\");\n}\n\nif (sentence == \"\") {\n    console.log(\"Hi! How may I help you? Checkout more information at https://github.com/simonxeko/kai2\");\n} else if(matches.length == 0) {\n    if(C.shortcut[sentence]) {\n        console.log('Do you mean: \"'+ (\"kai run \" + sentence).cyan +'\"?')\n    } else {\n        console.log(\"I don't quite understand the command.\");\n    }\n}"],"sourceRoot":"/Users/simon/Dev/kai2/src"}